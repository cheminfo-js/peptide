/** peptide@1.6.0, MIT licensed. https://github.com/cheminfo-js/peptide */
!function(a,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Peptide=e():a.Peptide=e()}("undefined"!=typeof self?self:this,function(){return function(a){var e={};function r(n){if(e[n])return e[n].exports;var t=e[n]={i:n,l:!1,exports:{}};return a[n].call(t.exports,t,t.exports,r),t.l=!0,t.exports}return r.m=a,r.c=e,r.d=function(a,e,n){r.o(a,e)||Object.defineProperty(a,e,{configurable:!1,enumerable:!0,get:n})},r.n=function(a){var e=a&&a.__esModule?function(){return a.default}:function(){return a};return r.d(e,"a",e),e},r.o=function(a,e){return Object.prototype.hasOwnProperty.call(a,e)},r.p="",r(r.s=2)}([function(a,e,r){"use strict";a.exports=[{name:"Alanine",aa3:"Ala",aa1:"A",sc:{type:"hydrophobic"},pKaC:2.33,pKaN:9.71},{name:"Arginine",aa3:"Arg",aa1:"R",sc:{type:"positive",pKa:12.1},pKaC:2.03,pKaN:9},{name:"Asparagine",aa3:"Asn",aa1:"N",sc:{type:"polar"},pKaC:2.13,pKaN:9.05},{name:"Aspartic acid",aa3:"Asp",aa1:"D",sc:{type:"negative",pKa:3.71},pKaC:1.95,pKaN:9.66},{name:"Cysteine",aa3:"Cys",aa1:"C",sc:{type:"special",pKa:8.14},pKaC:1.91,pKaN:10.28},{name:"Glutamic acid",aa3:"Glu",aa1:"E",sc:{type:"negative",pKa:4.15},pKaC:2.16,pKaN:9.58},{name:"Glutamine",aa3:"Gln",aa1:"Q",sc:{type:"polar"},pKaC:2.18,pKaN:9},{name:"Glycine",aa3:"Gly",aa1:"G",sc:{type:"special"},pKaC:2.34,pKaN:9.58},{name:"Histidine",aa3:"His",aa1:"H",sc:{type:"positive",pKa:6.04},pKaC:1.7,pKaN:9.09},{name:"Isoleucine",aa3:"Ile",aa1:"I",sc:{type:"hydrophobic"},pKaC:2.26,pKaN:9.6},{name:"Leucine",aa3:"Leu",aa1:"L",sc:{type:"hydrophobic"},pKaC:2.32,pKaN:9.58},{name:"Lysine",aa3:"Lys",aa1:"K",sc:{type:"positive",pKa:10.67},pKaC:2.15,pKaN:9.16},{name:"Methionine",aa3:"Met",aa1:"M",sc:{type:"hydrophobic"},pKaC:2.16,pKaN:9.08},{name:"Phenylalanine",aa3:"Phe",aa1:"F",sc:{type:"hydrophobic"},pKaC:2.18,pKaN:9.09},{name:"Proline",aa3:"Pro",aa1:"P",sc:{type:"special"},pKaC:1.95,pKaN:10.47},{name:"Serine",aa3:"Ser",aa1:"S",sc:{type:"polar"},pKaC:2.13,pKaN:9.05},{name:"Threonine",aa3:"Thr",aa1:"T",sc:{type:"polar"},pKaC:2.2,pKaN:8.96},{name:"Tryptophan",aa3:"Trp",aa1:"W",sc:{type:"hydrophobic"},pKaC:2.38,pKaN:9.34},{name:"Tyrosine",aa3:"Tyr",aa1:"Y",sc:{type:"hydrophobic"},pKaC:2.24,pKaN:9.04},{name:"Valine",aa3:"Val",aa1:"V",sc:{type:"hydrophobic"},pKaC:2.27,pKaN:9.52},{name:"Selenocysteine",aa3:"Sec",aa1:"U"},{name:"Pyrrolysine",aa3:"Pyl",aa1:"O"},{name:"Asparagine or aspartic acid",aa3:"Asx",aa1:"B"},{name:"Glutamine or glutamic acid",aa3:"Glx",aa1:"Z"},{name:"Leucine or isoleucine",aa3:"Xle",aa1:"J"},{name:"Unspecified or unknown",aa3:"Xaa",aa1:"X"}]},function(a,e,r){"use strict";a.exports=function(a){for(var e=a.replace(/([A-Z])/g," $1").split(/ /),r=0;""===e[r]||"H"===e[r];)r++;for(var n=e.length-1;"O"===e[n]||"H"===e[n];)n--;return e=e.slice(r,n+1)}},function(a,e,r){"use strict";var n=r(0),t=r(3),i=r(4),c=r(6),s=r(1),p=r(7),o=r(8);function u(a){for(var e=0;e<n.length;e++)if(n[e].aa1===a)return n[e].aa3;throw new Error("Invalid 1 letter code: "+a)}e.getInfo=function(){return n},e.splitPeptide=s,e.digestPeptide=p,e.calculateIEP=function(a){var e=s(a);return t.calculateIEP(e)},e.calculateIEPChart=function(a){var e=s(a);return t.calculateChart(e)},e.getColorForIEP=function(a){return t.getColor(a)},e.calculateCharge=function(a,e){var r=s(a);return t.calculateCharge(r,e)},e.generatePeptideFragments=o,e.chargePeptide=i,e.allowNeutralLoss=c,e.convertAASequence=function(a){var e=a;if(a.search(/[A-Z]{3} [A-Z]{3} [A-Z]{3}/)>-1){var r=a.replace(/[\r\n]+/g," "),n=(r=r.replace(/(SEQRES|[0-9]+| [A-Z] | [0-9A-Z]{4-50})/g,"")).split(" ");e="H";for(var t=0;t<n.length;t++)e+=n[t].substr(0,1)+n[t].substr(1).toLowerCase();e+="OH"}else a.search(/[A-Z]{3}/)>-1&&-1==a.search(/[a-zA-Z][a-z0-9]/)&&(e="H"+function(a){for(var e="",r=0;r<a.length;r++)e+=u(a.charAt(r));return e}(e.replace(/[^A-Z]/g,""))+"OH");return e}},function(a,e,r){"use strict";for(var n=r(0),t={},i=0;i<n.length;i++)t[n[i].aa3]=n[i];function c(a,e){var r=0;for(var n in r+=1/(1+Math.pow(10,e-a.first)),r+=-1/(1+Math.pow(10,a.last-e)),a.acid)r+=-a.acid[n]/(1+Math.pow(10,t[n].sc.pKa-e));for(var n in a.basic)r+=a.basic[n]/(1+Math.pow(10,e-t[n].sc.pKa));return r}function s(a){var e={};if(t[a[0]]&&(e.first=t[a[0]].pKaN,t[a[a.length-1]])){e.last=t[a[a.length-1]].pKaC,e.basic={},e.acid={};for(var r=0;r<a.length;r++){var n=a[r];if(!t[n])return;t[n].sc&&t[n].sc.type&&("positive"==t[n].sc.type?(e.basic[n]||(e.basic[n]=0),e.basic[n]++):"negative"==t[n].sc.type&&(e.acid[n]||(e.acid[n]=0),e.acid[n]++))}return e}}a.exports={calculateIEP:function(a){var e=s(a);if(e){for(var r,n=0,t=14,i=14,p=0;Math.abs(i-p)>1e-4;)p=i,(r=c(e,i=(t+n)/2))>0?n=i:r<0?t=i:p=i;return Math.round(1e3*i)/1e3}},calculateCharge:function(a,e){e||(e=7);var r=s(a);if(r){var n=c(r,e);return Math.round(1e3*n)/1e3}},calculateChart:function(a){var e=s(a);if(e){for(var r=[],n=[],t=[],i=0;i<=14;i+=.01){var p=c(e,i);n.push(i),r.push(p),t.push(Math.abs(p))}return e.x=n,e.y=r,e.yAbs=t,e}},getColor:function(a){var e;return a<7?(a<3&&(a=3),"rgb("+(e=Math.round(255-50*(7-a)))+","+e+",255)"):a>7?(a>11&&(a=11),"rgb(255,"+(e=Math.round(255-50*(a-7)))+","+e+")"):"rgb(255,255,255)"}}},function(a,e,r){"use strict";var n=r(5);function t(a,e){var r=e.pH;if(a.match(/^H[A-Z][a-z]{2}/)){var t=a.replace(/^H([A-Z][a-z]{2}).*/,"$1");n(t)&&r<n(t).pKaN&&(a=a.replace(/^H([^+])/,"H+H$1"))}if(a.match(/[A-Z][a-z]{2}OH$/)){a.replace(/.*([A-Z][a-z]{2})OH$/,"$1");n(t)&&r>n(t).pKaC&&(a=a.replace(/OH$/,"O-"))}return r<n("Arg").sc.pKa&&(a=a.replace(/(Arg)(?!\()/g,"$1(H+)")),r<n("His").sc.pKa&&(a=a.replace(/(His)(?!\()/g,"$1(H+)")),r<n("Lys").sc.pKa&&(a=a.replace(/(Lys)(?!\()/g,"$1(H+)")),r>n("Asp").sc.pKa&&(a=a.replace(/(Asp)(?!\()/g,"$1(H-1-)")),r>n("Glu").sc.pKa&&(a=a.replace(/(Glu)(?!\()/g,"$1(H-1-)")),r>n("Cys").sc.pKa&&(a=a.replace(/(Cys)(?!\()/g,"$1(H-1-)")),a}a.exports=function(a,e){if(void 0===(e=e||{}).pH&&(e.pH=0),Array.isArray(a)){for(var r=0;r<a.length;r++)a[r]=t(a[r],e);return a}return t(a,e)}},function(a,e,r){"use strict";var n=r(0);a.exports=function(a){if(1===a.length)for(var e=0;e<n.length;e++)if(n[e].aa1===a)return n[e];if(3===a.length)for(e=0;e<n.length;e++)if(n[e].aa3===a)return n[e]}},function(a,e,r){"use strict";function n(a,e){return a=(a=a.replace(/(Ser|Thr|Asp|Glu)(?!\()/g,"$1(H-2O-1)0-1")).replace(/(Arg|Lys|Asn|Gln)(?!\()/g,"$1(N-1H-3)0-1")}a.exports=function(a,e){if(Array.isArray(a)){for(var r=0;r<a.length;r++)a[r]=n(a[r]);return a}return n(a)}},function(a,e,r){"use strict";var n=r(1);a.exports=function(a,e){e=e||{},a=a.replace(/^H([^a-z])/,"$1").replace(/OH$/,""),e.enzyme=e.enzyme||"trypsin",void 0===e.minMissed&&(e.minMissed=0),void 0===e.maxMissed&&(e.maxMissed=0),void 0===e.minResidue&&(e.minResidue=0),void 0===e.maxResidue&&(e.maxResidue=Number.MAX_VALUE);var r=function(a){switch(a.toLowerCase().replace(/[^a-z0-9]/g,"")){case"chymotrypsin":return/(Phe|Tyr|Trp)(?!Pro)/g;case"trypsin":return/(Lys|Arg)(?!Pro)/g;case"lysc":return/(Lys)(?!Pro)/g;case"glucph4":return/(Glu)(?!Pro|Glu)/g;case"glucph8":return/(Asp|Glu)(?!Pro|Glu)/g;case"thermolysin":return/(Leu|Ile|Met|Phe|Trp)/g;case"cyanogenbromide":return/(Met)/g}throw new Error("Digestion enzyme: "+a+" is unknown")}(e.enzyme),t=a.replace(r,"$1 ").split(/ /);t[t.length-1]||(t=t.slice(0,t.length-1));for(var i=0,c=0;c<t.length;c++){var s=n(t[c]).length;t[c]={sequence:t[c],nbResidue:s,from:i+1,to:i+s},i+=s}var p=[];for(c=0;c<t.length-e.minMissed;c++)for(var o=e.minMissed;o<=Math.min(e.maxMissed,t.length-c-1);o++){for(var u="",l=(s=0,c);l<=c+o;l++)u+=t[l].sequence,s+=t[l].nbResidue;i=t[c].from;var f=t[c+o].to;u&&s>=e.minResidue&&s<=e.maxResidue&&p.push("H"+u+"OH$D"+i+">"+f)}return p}},function(a,e,r){"use strict";function n(a,e,r,n){n.a&&a.push(e+"C-1O-1(+1)$a"+r),n.b&&a.push(e+"(+1)$b"+r),n.c&&a.push(e+"NH3(+1)$c"+r)}function t(a,e,r,n,t){t.ya&&a.push("H"+e+"C-1O-1(+1)$a"+n+"y"+r),t.yb&&a.push("H"+e+"(+1)$b"+n+"y"+r),t.yc&&a.push("H"+e+"NH3(+1)$c"+n+"y"+r),t.zc&&a.push("N-1"+e+"NH3(+1)$c"+n+"z"+r)}function i(a,e,r,n){n.x&&a.push("CO(+1)"+e+"$x"+r),n.y&&a.push("H2(+1)"+e+"$y"+r),n.z&&a.push("N-1H-1(+1)"+e+"$z"+r)}a.exports=function(a,e){void 0===e&&(e={a:!1,b:!0,c:!1,x:!1,y:!0,z:!1,i:!1,ya:!1,yb:!1,yc:!1,zc:!1}),e.maxInternal=e.maxInternal||Number.MAX_VALUE,e.minInternal=e.minInternal||0;for(var r=[],c=a.replace(/([a-z\)0-9])([A-Z][a-z](?=[a-z]))/g,"$1 $2").split(/ /),s="",p="",o=1;o<c.length;o++)if(s+=c[o-1],p=c[c.length-o]+p,n(r,s,o,e),i(r,p,o,e),e.i&&r.push(c[o]+"HC-1O-1(+1)$i:"+c[o]),e.ya||e.yb||e.yc||e.zc)for(var u=o+1;u<Math.min(c.length,e.maxInternal+o+1);u++){var l="";if(u-o>=e.minInternal){for(var f=o;f<u;f++)l+=c[f];t(r,l,c.length-o,u,e)}}return 0===r.length&&(r=r.concat([a])),r}}])});
//# sourceMappingURL=peptide.min.js.map