!function(a,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Peptide=e():a.Peptide=e()}(this,function(){return function(a){function e(n){if(r[n])return r[n].exports;var t=r[n]={exports:{},id:n,loaded:!1};return a[n].call(t.exports,t,t.exports,e),t.loaded=!0,t.exports}var r={};return e.m=a,e.c=r,e.p="",e(0)}([function(a,e,r){"use strict";function n(a){for(var e=0;e<i.length;e++)if(i[e].aa1===a)return i[e].aa3;throw new Error("Invalid 1 letter code: "+a)}function t(a){for(var e="",r=0;r<a.length;r++)e+=n(a.charAt(r));return e}var i=r(1),c=r(2),p=r(3),s=r(5),o=r(6),u=r(7),l=r(8);e.getInfo=function(){return i},e.splitPeptide=o,e.digestPeptide=u,e.calculateIEP=function(a){var e=o(a),r=c.calculateIEP(e);return r},e.calculateIEPChart=function(a){var e=o(a),r=c.calculateChart(e);return r},e.getColorForIEP=function(a){return c.getColor(a)},e.calculateCharge=function(a,e){var r=o(a);return c.calculateCharge(r,e)},e.generatePeptideFragments=l,e.chargePeptide=p,e.allowNeutralLoss=s,e.convertAASequence=function(a){var e=a;if(a.search(/[A-Z]{3} [A-Z]{3} [A-Z]{3}/)>-1){var r=a.replace(/[\r\n]+/g," ");r=r.replace(/(SEQRES|[0-9]+| [A-Z] | [0-9A-Z]{4-50})/g,"");var n=r.split(" ");e="H";for(var i=0;i<n.length;i++)e+=n[i].substr(0,1)+n[i].substr(1).toLowerCase();e+="OH"}else a.search(/[A-Z]{3}/)>-1&&-1==a.search(/[a-zA-Z][a-z0-9]/)&&(e="H"+t(e.replace(/[^A-Z]/g,""))+"OH");return e}},function(a,e){"use strict";a.exports=[{name:"Alanine",aa3:"Ala",aa1:"A",sc:{type:"hydrophobic"},pKaC:2.33,pKaN:9.71},{name:"Arginine",aa3:"Arg",aa1:"R",sc:{type:"positive",pKa:12.1},pKaC:2.03,pKaN:9},{name:"Asparagine",aa3:"Asn",aa1:"N",sc:{type:"polar"},pKaC:2.13,pKaN:9.05},{name:"Aspartic acid",aa3:"Asp",aa1:"D",sc:{type:"negative",pKa:3.71},pKaC:1.95,pKaN:9.66},{name:"Cysteine",aa3:"Cys",aa1:"C",sc:{type:"special",pKa:8.14},pKaC:1.91,pKaN:10.28},{name:"Glutamic acid",aa3:"Glu",aa1:"E",sc:{type:"negative",pKa:4.15},pKaC:2.16,pKaN:9.58},{name:"Glutamine",aa3:"Gln",aa1:"Q",sc:{type:"polar"},pKaC:2.18,pKaN:9},{name:"Glycine",aa3:"Gly",aa1:"G",sc:{type:"special"},pKaC:2.34,pKaN:9.58},{name:"Histidine",aa3:"His",aa1:"H",sc:{type:"positive",pKa:6.04},pKaC:1.7,pKaN:9.09},{name:"Isoleucine",aa3:"Ile",aa1:"I",sc:{type:"hydrophobic"},pKaC:2.26,pKaN:9.6},{name:"Leucine",aa3:"Leu",aa1:"L",sc:{type:"hydrophobic"},pKaC:2.32,pKaN:9.58},{name:"Lysine",aa3:"Lys",aa1:"K",sc:{type:"positive",pKa:10.67},pKaC:2.15,pKaN:9.16},{name:"Methionine",aa3:"Met",aa1:"M",sc:{type:"hydrophobic"},pKaC:2.16,pKaN:9.08},{name:"Phenylalanine",aa3:"Phe",aa1:"F",sc:{type:"hydrophobic"},pKaC:2.18,pKaN:9.09},{name:"Proline",aa3:"Pro",aa1:"P",sc:{type:"special"},pKaC:1.95,pKaN:10.47},{name:"Serine",aa3:"Ser",aa1:"S",sc:{type:"polar"},pKaC:2.13,pKaN:9.05},{name:"Threonine",aa3:"Thr",aa1:"T",sc:{type:"polar"},pKaC:2.2,pKaN:8.96},{name:"Tryptophan",aa3:"Trp",aa1:"W",sc:{type:"hydrophobic"},pKaC:2.38,pKaN:9.34},{name:"Tyrosine",aa3:"Tyr",aa1:"Y",sc:{type:"hydrophobic"},pKaC:2.24,pKaN:9.04},{name:"Valine",aa3:"Val",aa1:"V",sc:{type:"hydrophobic"},pKaC:2.27,pKaN:9.52},{name:"Selenocysteine",aa3:"Sec",aa1:"U"},{name:"Pyrrolysine",aa3:"Pyl",aa1:"O"},{name:"Asparagine or aspartic acid",aa3:"Asx",aa1:"B"},{name:"Glutamine or glutamic acid",aa3:"Glx",aa1:"Z"},{name:"Leucine or isoleucine",aa3:"Xle",aa1:"J"},{name:"Unspecified or unknown",aa3:"Xaa",aa1:"X"}]},function(a,e,r){"use strict";function n(a,e){e||(e=7);var r=p(a);if(r){var n=c(r,e);return Math.round(1e3*n)/1e3}}function t(a){var e=p(a);if(e){for(var r,n=0,t=14,i=14,s=0;Math.abs(i-s)>1e-4;)s=i,i=(t+n)/2,r=c(e,i),r>0?n=i:0>r?t=i:s=i;return Math.round(1e3*i)/1e3}}function i(a){var e=p(a);if(e){for(var r=[],n=[],t=0;14>=t;t+=.01){var i=c(e,t);r.push(i),n.push(Math.abs(i))}return e.y=r,e.yAbs=n,e}}function c(a,e){var r=0;r+=1/(1+Math.pow(10,e-a.first)),r+=-1/(1+Math.pow(10,a.last-e));for(var n in a.acid)r+=-a.acid[n]/(1+Math.pow(10,u[n].sc.pKa-e));for(var n in a.basic)r+=a.basic[n]/(1+Math.pow(10,e-u[n].sc.pKa));return r}function p(a){var e={};if(u[a[0]]&&(e.first=u[a[0]].pKaN,u[a[a.length-1]])){e.last=u[a[a.length-1]].pKaC,e.basic={},e.acid={};for(var r=0;r<a.length;r++){var n=a[r];if(!u[n])return;u[n].sc&&u[n].sc.type&&("positive"==u[n].sc.type?(e.basic[n]||(e.basic[n]=0),e.basic[n]++):"negative"==u[n].sc.type&&(e.acid[n]||(e.acid[n]=0),e.acid[n]++))}return e}}function s(a){if(7>a){3>a&&(a=3);var e=Math.round(255-50*(7-a));return"rgb("+e+","+e+",255)"}if(a>7){a>11&&(a=11);var e=Math.round(255-50*(a-7));return"rgb(255,"+e+","+e+")"}return"rgb(255,255,255)"}for(var o=r(1),u={},l=0;l<o.length;l++)u[o[l].aa3]=o[l];a.exports={calculateIEP:t,calculateCharge:n,calculateChart:i,getColor:s}},function(a,e,r){"use strict";function n(a,e){var e=e||{};if(void 0===e.pH&&(e.pH=0),Array.isArray(a)){for(var r=0;r<a.length;r++)a[r]=t(a[r],e);return a}return t(a,e)}function t(a,e){var r=e.pH;if(a.match(/^H[A-Z][a-z]{2}/)){var n=a.replace(/^H([A-Z][a-z]{2}).*/,"$1");i(n)&&r<i(n).pKaN&&(a=a.replace(/^H([^+])/,"H+H$1"))}if(a.match(/[A-Z][a-z]{2}OH$/)){a.replace(/.*([A-Z][a-z]{2})OH$/,"$1");i(n)&&r>i(n).pKaC&&(a=a.replace(/OH$/,"O-"))}return r<i("Arg").sc.pKa&&(a=a.replace(/(Arg)(?!\()/g,"$1(H+)")),r<i("His").sc.pKa&&(a=a.replace(/(His)(?!\()/g,"$1(H+)")),r<i("Lys").sc.pKa&&(a=a.replace(/(Lys)(?!\()/g,"$1(H+)")),r>i("Asp").sc.pKa&&(a=a.replace(/(Asp)(?!\()/g,"$1(H-1-)")),r>i("Glu").sc.pKa&&(a=a.replace(/(Glu)(?!\()/g,"$1(H-1-)")),r>i("Cys").sc.pKa&&(a=a.replace(/(Cys)(?!\()/g,"$1(H-1-)")),a}var i=r(4);a.exports=n},function(a,e,r){"use strict";function n(a){if(1===a.length)for(var e=0;e<t.length;e++)if(t[e].aa1===a)return t[e];if(3===a.length)for(var e=0;e<t.length;e++)if(t[e].aa3===a)return t[e]}var t=r(1);a.exports=n},function(a,e){function r(a,e){if(Array.isArray(a)){for(var r=0;r<a.length;r++)a[r]=n(a[r],e);return a}return n(a,e)}function n(a,e){return a=a.replace(/(Ser|Thr|Asp|Glu)(?!\()/g,"$1(H-2O-1)0-1"),a=a.replace(/(Arg|Lys|Asn|Gln)(?!\()/g,"$1(N-1H-3)0-1")}a.exports=r},function(a,e){"use strict";function r(a){for(var e=a.replace(/([A-Z])/g," $1").split(/ /),r=0;""===e[r]||"H"===e[r];)r++;for(var n=e.length-1;"O"===e[n]||"H"===e[n];)n--;return e=e.slice(r,n+1)}a.exports=r},function(a,e,r){"use strict";function n(a,e){var e=e||{};a=a.replace(/^H([^a-z])/,"$1").replace(/OH$/,""),e.enzyme=e.enzyme||"trypsin",void 0===e.minMissed&&(e.minMissed=0),void 0===e.maxMissed&&(e.maxMissed=0),void 0===e.minResidue&&(e.minResidue=0),void 0===e.maxResidue&&(e.maxResidue=Number.MAX_VALUE);var r=t(e.enzyme),n=a.replace(r,"$1 ").split(/ /);n[n.length-1]||(n=n.slice(0,n.length-1));for(var c=0,p=0;p<n.length;p++){var s=i(n[p]).length;n[p]={sequence:n[p],nbResidue:s,from:c+1,to:c+s},c+=s}for(var o=[],p=0;p<n.length-e.minMissed;p++)for(var u=e.minMissed;u<=Math.min(e.maxMissed,n.length-p-1);u++){for(var l="",s=0,f=p;p+u>=f;f++)l+=n[f].sequence,s+=n[f].nbResidue;var c=n[p].from,h=n[p+u].to;l&&s>=e.minResidue&&s<=e.maxResidue&&o.push("H"+l+"OH$D"+c+">"+h)}return o}function t(a){switch(a.toLowerCase().replace(/[^a-z0-9]/g,"")){case"chymotrypsin":return/(Phe|Tyr|Trp)(?!Pro)/g;case"trypsin":return/(Lys|Arg)(?!Pro)/g;case"lysc":return/(Lys)(?!Pro)/g;case"glucph4":return/(Glu)(?!Pro|Glu)/g;case"glucph8":return/(Asp|Glu)(?!Pro|Glu)/g;case"thermolysin":return/(Leu|Ile|Met|Phe|Trp)/g;case"cyanogenbromide":return/(Met)/g}throw new Error("Digestion enzyme: "+a+" is unknown")}var i=r(6);a.exports=n},function(a,e){"use strict";function r(a,e,r,n){n.a&&a.push(e+"C-1O-1(+1)$a"+r),n.b&&a.push(e+"(+1)$b"+r),n.c&&a.push(e+"NH3(+1)$c"+r)}function n(a,e,r,n,t){t.ya&&a.push("H"+e+"C-1O-1(+1)$a"+n+"y"+r),t.yb&&a.push("H"+e+"(+1)$b"+n+"y"+r)}function t(a,e,r,n){n.x&&a.push("CO(+1)"+e+"$x"+r),n.y&&a.push("H2(+1)"+e+"$y"+r),n.z&&a.push("N-1H-1(+1)"+e+"$z"+r)}a.exports=function(a,e){void 0===e&&(e={a:!1,b:!0,c:!1,x:!1,y:!0,z:!1,i:!1,yb:!1,ya:!1}),e.maxInternal=e.maxInternal||Number.MAX_VALUE,e.minInternal=e.minInternal||0;for(var i=[],c=a.replace(/([a-z\)0-9])([A-Z][a-z](?=[a-z]))/g,"$1 $2").split(/ /),p="",s="",o=1;o<c.length;o++)if(p+=c[o-1],s=c[c.length-o]+s,r(i,p,o,e),t(i,s,o,e),e.i&&i.push(c[o]+"HC-1O-1(+1)$i:"+c[o]),e.ya||e.yb)for(var u=o+1;u<Math.min(c.length,e.maxInternal+o+1);u++){var l="";if(u-o>=e.minInternal){for(var f=o;u>f;f++)l+=c[f];n(i,l,c.length-o,u,e)}}return 0===i.length&&(i=i.concat([a])),i}}])});
//# sourceMappingURL=peptide.min.js.map