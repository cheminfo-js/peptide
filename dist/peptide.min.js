!function(e,a){"object"==typeof exports&&"object"==typeof module?module.exports=a():"function"==typeof define&&define.amd?define([],a):"object"==typeof exports?exports.Peptide=a():e.Peptide=a()}("undefined"!=typeof self?self:this,(function(){return function(e){var a={};function t(n){if(a[n])return a[n].exports;var r=a[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}return t.m=e,t.c=a,t.d=function(e,a,n){t.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,a){if(1&a&&(e=t(e)),8&a)return e;if(4&a&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&a&&"string"!=typeof e)for(var r in e)t.d(n,r,function(a){return e[a]}.bind(null,r));return n},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},t.p="",t(t.s=1)}([function(e,a,t){"use strict";e.exports=[{name:"Alanine",aa3:"Ala",aa1:"A",sc:{type:"hydrophobic"},pKaC:2.33,pKaN:9.71},{name:"Arginine",aa3:"Arg",aa1:"R",sc:{type:"positive",pKa:12.1},pKaC:2.03,pKaN:9},{name:"Asparagine",aa3:"Asn",aa1:"N",sc:{type:"polar"},pKaC:2.13,pKaN:9.05},{name:"Aspartic acid",aa3:"Asp",aa1:"D",sc:{type:"negative",pKa:3.71},pKaC:1.95,pKaN:9.66},{name:"Cysteine",aa3:"Cys",aa1:"C",sc:{type:"special",pKa:8.14},pKaC:1.91,pKaN:10.28},{name:"Glutamic acid",aa3:"Glu",aa1:"E",sc:{type:"negative",pKa:4.15},pKaC:2.16,pKaN:9.58},{name:"Glutamine",aa3:"Gln",aa1:"Q",sc:{type:"polar"},pKaC:2.18,pKaN:9},{name:"Glycine",aa3:"Gly",aa1:"G",sc:{type:"special"},pKaC:2.34,pKaN:9.58},{name:"Histidine",aa3:"His",aa1:"H",sc:{type:"positive",pKa:6.04},pKaC:1.7,pKaN:9.09},{name:"Isoleucine",aa3:"Ile",aa1:"I",sc:{type:"hydrophobic"},pKaC:2.26,pKaN:9.6},{name:"Leucine",aa3:"Leu",aa1:"L",sc:{type:"hydrophobic"},pKaC:2.32,pKaN:9.58},{name:"Lysine",aa3:"Lys",aa1:"K",sc:{type:"positive",pKa:10.67},pKaC:2.15,pKaN:9.16},{name:"Methionine",aa3:"Met",aa1:"M",sc:{type:"hydrophobic"},pKaC:2.16,pKaN:9.08},{name:"Phenylalanine",aa3:"Phe",aa1:"F",sc:{type:"hydrophobic"},pKaC:2.18,pKaN:9.09},{name:"Proline",aa3:"Pro",aa1:"P",sc:{type:"special"},pKaC:1.95,pKaN:10.47},{name:"Serine",aa3:"Ser",aa1:"S",sc:{type:"polar"},pKaC:2.13,pKaN:9.05},{name:"Threonine",aa3:"Thr",aa1:"T",sc:{type:"polar"},pKaC:2.2,pKaN:8.96},{name:"Tryptophan",aa3:"Trp",aa1:"W",sc:{type:"hydrophobic"},pKaC:2.38,pKaN:9.34},{name:"Tyrosine",aa3:"Tyr",aa1:"Y",sc:{type:"hydrophobic"},pKaC:2.24,pKaN:9.04},{name:"Valine",aa3:"Val",aa1:"V",sc:{type:"hydrophobic"},pKaC:2.27,pKaN:9.52},{name:"Selenocysteine",aa3:"Sec",aa1:"U"},{name:"Pyrrolysine",aa3:"Pyl",aa1:"O"},{name:"Asparagine or aspartic acid",aa3:"Asx",aa1:"B"},{name:"Glutamine or glutamic acid",aa3:"Glx",aa1:"Z"},{name:"Leucine or isoleucine",aa3:"Xle",aa1:"J"},{name:"Unspecified or unknown",aa3:"Xaa",aa1:"X"}]},function(e,a,t){"use strict";const n=t(0),r=t(2),c=t(3),o=t(5),i=t(6),l=t(7),s=t(8),p=t(9);a.getInfo=function(){return n},a.splitPeptide=i,a.digestPeptide=l,a.calculateIEP=function(e){let a=i(e);return r.calculateIEP(a)},a.calculateIEPChart=function(e){let a=i(e);return r.calculateChart(a)},a.getColorForIEP=function(e){return r.getColor(e)},a.calculateCharge=function(e,a){let t=i(e);return r.calculateCharge(t,a)},a.generatePeptideFragments=s,a.chargePeptide=c,a.allowNeutralLoss=o,a.convertAASequence=p,a.sequenceToMF=p},function(e,a,t){"use strict";let n=t(0),r={};for(let e=0;e<n.length;e++)r[n[e].aa3]=n[e];function c(e,a){let t=0;t+=1/(1+Math.pow(10,a-e.first)),t+=-1/(1+Math.pow(10,e.last-a));for(let n in e.acid)t+=-e.acid[n]/(1+Math.pow(10,r[n].sc.pKa-a));for(let n in e.basic)t+=e.basic[n]/(1+Math.pow(10,a-r[n].sc.pKa));return t}function o(e){let a={};if(r[e[0]]&&(a.first=r[e[0]].pKaN,r[e[e.length-1]])){a.last=r[e[e.length-1]].pKaC,a.basic={},a.acid={};for(let t=0;t<e.length;t++){let n=e[t];if(!r[n])return;r[n].sc&&r[n].sc.type&&("positive"===r[n].sc.type?(a.basic[n]||(a.basic[n]=0),a.basic[n]++):"negative"===r[n].sc.type&&(a.acid[n]||(a.acid[n]=0),a.acid[n]++))}return a}}e.exports={calculateIEP:function(e){let a=o(e);if(!a)return;let t,n=0,r=14,i=14,l=0;for(;Math.abs(i-l)>1e-4;)l=i,(t=c(a,i=(r+n)/2))>0?n=i:t<0?r=i:l=i;return Math.round(1e3*i)/1e3},calculateCharge:function(e,a){a||(a=7);let t=o(e);if(!t)return;let n=c(t,a);return Math.round(1e3*n)/1e3},calculateChart:function(e){let a=o(e);if(!a)return;let t=[],n=[],r=[];for(let e=0;e<=14;e+=.01){let o=c(a,e);n.push(e),t.push(o),r.push(Math.abs(o))}return a.x=n,a.y=t,a.yAbs=r,a},getColor:function(e){if(e<7){e<3&&(e=3);let a=Math.round(255-50*(7-e));return"rgb(".concat(a,",").concat(a,",255)")}if(e>7){e>11&&(e=11);let a=Math.round(255-50*(e-7));return"rgb(255,".concat(a,",").concat(a,")")}return"rgb(255,255,255)"}}},function(e,a,t){"use strict";let n=t(4);function r(e,a){let t=a.pH;if(e.match(/^H[A-Z][a-z]{2}/)){let a=e.replace(/^H([A-Z][a-z]{2}).*/,"$1");n(a)&&t<n(a).pKaN&&(e=e.replace(/^H([^+])/,"H+H$1"))}if(e.match(/[A-Z][a-z]{2}OH$/)){let a=e.replace(/.*([A-Z][a-z]{2})OH$/,"$1");n(a)&&t>n(a).pKaC&&(e=e.replace(/OH$/,"O-"))}return t<n("Arg").sc.pKa&&(e=e.replace(/(Arg)(?!\()/g,"$1(H+)")),t<n("His").sc.pKa&&(e=e.replace(/(His)(?!\()/g,"$1(H+)")),t<n("Lys").sc.pKa&&(e=e.replace(/(Lys)(?!\()/g,"$1(H+)")),t>n("Asp").sc.pKa&&(e=e.replace(/(Asp)(?!\()/g,"$1(H-1-)")),t>n("Glu").sc.pKa&&(e=e.replace(/(Glu)(?!\()/g,"$1(H-1-)")),t>n("Cys").sc.pKa&&(e=e.replace(/(Cys)(?!\()/g,"$1(H-1-)")),e}e.exports=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0===a.pH&&(a.pH=0),Array.isArray(e)){for(let t=0;t<e.length;t++)e[t]=r(e[t],a);return e}return r(e,a)}},function(e,a,t){"use strict";let n=t(0);e.exports=function(e){if(1===e.length)for(let a=0;a<n.length;a++)if(n[a].aa1===e)return n[a];if(3===e.length)for(let a=0;a<n.length;a++)if(n[a].aa3===e)return n[a]}},function(e,a,t){"use strict";function n(e){return e=(e=e.replace(/(Ser|Thr|Asp|Glu)(?!\()/g,"$1(H-2O-1)0-1")).replace(/(Arg|Lys|Asn|Gln)(?!\()/g,"$1(N-1H-3)0-1")}e.exports=function(e,a){if(Array.isArray(e)){for(let a=0;a<e.length;a++)e[a]=n(e[a]);return e}return n(e)}},function(e,a,t){"use strict";e.exports=function(e){let a=e.replace(/([A-Z])/g," $1").split(/ /),t=0;for(;""===a[t]||"H"===a[t];)t++;let n=a.length-1;for(;"O"===a[n]||"H"===a[n];)n--;return a=a.slice(t,n+1)}},function(e,a,t){"use strict";e.exports=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=e.replace(/^H([^a-z])/,"$1").replace(/OH$/,""),a.enzyme=a.enzyme||"trypsin",void 0===a.minMissed&&(a.minMissed=0),void 0===a.maxMissed&&(a.maxMissed=0),void 0===a.minResidue&&(a.minResidue=0),void 0===a.maxResidue&&(a.maxResidue=Number.MAX_VALUE);let t=function(e){switch(e.toLowerCase().replace(/[^a-z0-9]/g,"")){case"chymotrypsin":return/(Phe|Tyr|Trp)(?!Pro)/g;case"trypsin":return/(Lys|Arg)(?!Pro)/g;case"lysc":return/(Lys)(?!Pro)/g;case"glucph4":return/(Glu)(?!Pro|Glu)/g;case"glucph8":return/(Asp|Glu)(?!Pro|Glu)/g;case"thermolysin":return/()(?=Ile|Leu|Val|Ala|Met|Phe)/g;case"cyanogenbromide":return/(Met)/g;case"any":return/()(?=[A-Z][a-z][a-z])/g;default:throw new Error("Digestion enzyme: ".concat(e," is unknown"))}}(a.enzyme),n=e.replace(t,"$1 ").split(/ /).filter(e=>e),r=0;for(let e=0;e<n.length;e++){let a=n[e].replace(/([A-Z][a-z][a-z])/g," $1").split(/ /).filter(e=>e).length;n[e]={sequence:n[e],nbResidue:a,from:r,to:r+a-1},r+=a}let c=[];for(let e=0;e<n.length-a.minMissed;e++)for(let t=a.minMissed;t<=Math.min(a.maxMissed,n.length-e-1);t++){let r="",o=0;for(let a=e;a<=e+t;a++)r+=n[a].sequence,o+=n[a].nbResidue;let i=n[e].from+1,l=n[e+t].to+1;r&&o>=a.minResidue&&o<=a.maxResidue&&c.push("H".concat(r,"OH$D").concat(i,">").concat(l))}return c}},function(e,a,t){"use strict";function n(e,a,t,n){n.a&&e.push("".concat(a,"C-1O-1(+1)$a").concat(t)),n.b&&e.push("".concat(a,"(+1)$b").concat(t)),n.c&&e.push("".concat(a,"NH3(+1)$c").concat(t))}function r(e,a,t,n,r){r.ya&&e.push("H".concat(a,"C-1O-1(+1)$a").concat(n,"y").concat(t)),r.yb&&e.push("H".concat(a,"(+1)$b").concat(n,"y").concat(t)),r.yc&&e.push("H".concat(a,"NH3(+1)$c").concat(n,"y").concat(t)),r.zc&&e.push("N-1".concat(a,"NH3(+1)$c").concat(n,"z").concat(t))}function c(e,a,t,n){n.x&&e.push("CO(+1)".concat(a,"$x").concat(t)),n.y&&e.push("H2(+1)".concat(a,"$y").concat(t)),n.z&&e.push("N-1H-1(+1)".concat(a,"$z").concat(t))}e.exports=function(e,a){void 0===a&&(a={a:!1,b:!0,c:!1,x:!1,y:!0,z:!1,i:!1,ya:!1,yb:!1,yc:!1,zc:!1}),a.maxInternal=a.maxInternal||Number.MAX_VALUE,a.minInternal=a.minInternal||0;let t=[],o=e.replace(/([a-z)0-9])([A-Z][a-z](?=[a-z]))/g,"$1 $2").split(/ /),i="",l="";for(let e=1;e<o.length;e++)if(i+=o[e-1],l=o[o.length-e]+l,n(t,i,e,a),c(t,l,e,a),a.i&&t.push("".concat(o[e],"HC-1O-1(+1)$i:").concat(o[e])),a.ya||a.yb||a.yc||a.zc)for(let n=e+1;n<Math.min(o.length,a.maxInternal+e+1);n++){let c="";if(n-e>=a.minInternal){for(let a=e;a<n;a++)c+=o[a];r(t,c,o.length-e,n,a)}}return 0===t.length&&(t=t.concat([e])),t}},function(e,a,t){"use strict";const n=t(0);function r(e){let a="";for(let t=0;t<e.length;t++)a+=c(e.charAt(t));return a}function c(e){for(let a=0;a<n.length;a++)if(n[a].aa1===e)return n[a].aa3;throw new Error("Invalid 1 letter code: ".concat(e))}e.exports=function(e){let a=e;if(e.search(/[A-Z]{3} [A-Z]{3} [A-Z]{3}/)>-1){let t=e.replace(/[\r\n]+/g," "),n=(t=t.replace(/(SEQRES|[0-9]+| [A-Z] | [0-9A-Z]{4-50})/g,"")).split(" ");a="H";for(let e=0;e<n.length;e++)a+=n[e].substr(0,1)+n[e].substr(1).toLowerCase();a+="OH"}else if(e.includes("(")&&function(e){let a=0;for(let t of e){if(0===a&&t.match(/[a-z]/))return!1;"("===t&&a++,")"===t&&a--}return!0}(e)){a="";let t="H",n="OH",c=0;for(let o=0;o<e.length;o++){let i=e[o];"("===i||")"===i||c>0?("("===i&&(c++,0===o&&(t="")),")"===i&&(c--,o===e.length-1&&(n="")),a+=i):a+=r(i)}a=t+a+n}else e.search(/[A-Z]{3}/)>-1&&-1===e.search(/[a-zA-Z][a-z0-9]/)&&(a="H".concat(r(a.replace(/[^A-Z]/g,"")),"OH"));return a}}])}));
//# sourceMappingURL=peptide.min.js.map